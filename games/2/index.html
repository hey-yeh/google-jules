<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no">
    <title>Video Game Hangman</title> <!-- Changed title -->
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 20px; 
            background-color: #f0f8ff; /* AliceBlue fallback */
            background-image: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
            font-family: Arial, sans-serif; 
            color: #333; /* Dark grey default text */
            display: flex; 
            flex-direction: column;
            align-items: center;
        }
        #game-container { 
            width: 100%;
            max-width: 700px; 
            padding: 30px; 
            background-color: rgba(255, 255, 255, 0.9); /* Slightly transparent white */
            box-shadow: 0 8px 16px rgba(0,0,0,0.15); /* More pronounced shadow */
            border-radius: 15px; /* More rounded */
        }
        h1 { /* Game Title Styling */
            font-size: 2.8em;
            margin-bottom: 30px;
            text-align: center; 
            color: #2c3e50; /* Dark slate blue */
        }
        p { /* General paragraph text color */
            color: #495057;
        }
        /* Add more specific styles as needed for elements */
        #phrase-display {
            font-family: monospace;
            font-size: 2em; 
            letter-spacing: 0.3em; 
            margin-bottom: 25px; 
            padding: 15px; 
            border: 2px solid #dee2e6; /* Light grey border */
            background-color: #e9ecef; /* Very light grey background */
            text-align: center;
            /* overflow-x: auto; (Removed for normal wrapping) */
            white-space: normal;   /* Allows wrapping */
            overflow-wrap: break-word; /* Breaks long words/underscores if they overflow */
            line-height: 1.5;      /* Add some line height for multi-line phrases */
            color: #343a40; /* Darker shade for phrase text */
        }
        #guesses-left-display {
            margin-bottom: 25px; 
            font-size: 1.3em; 
            color: #495057; /* Softer dark grey */
        }
        #guess-input {
            padding: 10px; 
            margin-right: 10px;
            border: 2px solid #ced4da; /* Slightly more prominent border */
            border-radius: 5px; /* Rounded */
            font-size: 1.1em; 
            /* Text color will be inherited or default to browser's dark for inputs */
        }
        button {
            padding: 12px 20px; 
            background-color: #5cb85c; /* Pleasant green */
            color: white;
            border: none;
            border-radius: 5px; /* Slightly rounded */
            cursor: pointer;
            font-size: 1.1em; 
        }
        button:hover {
            background-color: #4cae4c; /* Slightly darker green */
        }
        #message-area {
            margin-top: 25px; 
            font-weight: bold;
            min-height: 30px; 
            font-size: 1.1em; 
            text-align: center; 
            color: #495057; /* Softer dark grey */
        }
        /* Styles for section divs */
        #game-container > div {
            margin-bottom: 25px; /* Add margin to direct div children of game-container */
        }
        #game-container > div:last-child { /* Remove margin from the last div (message-area's wrapper) if message-area itself has margin-top */
             margin-bottom: 0;
        }
    </style>
</head>
<body>
    <div id="game-container"> <!-- Added game container -->
        <h1>Video Game Hangman!</h1>

        <div> <!-- Wrapper for Phrase section -->
            <p>Phrase:</p>
            <div id="phrase-display">
                <!-- Phrase will be displayed here by game.ts -->
            </div>
        </div>

        <div> <!-- Wrapper for Guesses Left section -->
            <p>Guesses Left:</p>
            <div id="guesses-left-display">
                <!-- Guesses left will be displayed here -->
            </div>
        </div>

        <div> <!-- Wrapper for Input area -->
            <input type="text" id="guess-input" placeholder="Enter your guess">
            <button id="guess-button">Guess</button>
        </div>

        <div style="margin-top: 30px; text-align: center;"> <!-- Increased margin-top and centered button -->
            <button id="new-game-button">New Game</button>
        </div>

        <div id="message-area"> <!-- Message area is already a direct child, its margin-top is handled by its own style -->
            <!-- Game messages will appear here -->
        </div>
    </div>

    <script src="./game.js"></script>
    <script>
        // Initialize the game and set up event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Expose game functions from game.ts (they are attached to window.game)
            const game = window.game;

            if (game && game.startGame) {
                // Initial UI text before game starts
                document.getElementById('phrase-display').textContent = "Loading...";
                document.getElementById('guesses-left-display').textContent = "Loading...";
                document.getElementById('message-area').textContent = "Initializing game...";

                game.startGame(); // Start the game once the DOM is loaded
            } else {
                console.error("Game logic not found. Ensure game.ts is compiled and included correctly.");
                const messageArea = document.getElementById('message-area');
                if (messageArea) {
                    messageArea.textContent = "Error: Game logic could not be loaded. Ensure game.ts is compiled to game.js and included correctly.";
                }
                // Disable buttons if game can't load
                document.getElementById('guess-button').disabled = true;
                document.getElementById('new-game-button').disabled = true;
                return;
            }

            const guessButton = document.getElementById('guess-button');
            const guessInput = document.getElementById('guess-input');
            const newGameButton = document.getElementById('new-game-button');

            if (guessButton) {
                guessButton.addEventListener('click', () => {
                    if (!guessInput || !game || !game.submitGuess || !game.displayMessage) { // Ensure submitGuess is available
                        console.error("Required game functions (submitGuess) or input field not found.");
                        // Attempt to use displayMessage if available, otherwise alert
                        if (game && game.displayMessage) {
                            game.displayMessage("Error: Critical game function missing. Cannot submit guess.");
                        } else {
                            alert("Error: Critical game function missing.");
                        }
                        return;
                    }
                    const guessValue = guessInput.value.trim(); // trim here too
                    // No need for if(!guessValue) check here if submitGuess handles it, but good for early exit
                    if (!guessValue) {
                        game.displayMessage("Please enter a word or phrase to guess.");
                        guessInput.value = ""; // Clear input
                        return;
                    }

                    game.submitGuess(guessValue); // Single call to the new dispatcher
                    guessInput.value = ""; // Clear input
                });
            } else {
                console.error("Guess button not found.");
            }

            // Add keydown listener for 'Enter' key on the input field
            if (guessInput) { // Ensure guessInput exists
                guessInput.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter') {
                        event.preventDefault(); // Prevent default form submission if it were in a form
                        // Simulate a click on the guessButton to reuse the existing logic
                        // Ensure guessButton also exists before trying to click it
                        const guessButtonElement = document.getElementById('guess-button'); // Renamed to avoid conflict with outer scope `guessButton`
                        if (guessButtonElement) {
                            guessButtonElement.click();
                        } else {
                            console.error("Guess button not found for Enter key press.");
                            // Fallback or direct call to game logic if button is missing, though it shouldn't be
                            // This part is tricky as the original click handler has its own checks.
                            // For robustness, it's better if the core guess logic is a separate function
                            // that both handlers can call. But for now, clicking the button is simplest.
                        }
                    }
                });
            } else {
                console.error("Guess input field not found for adding keydown listener.");
            }

            if (newGameButton) {
                newGameButton.addEventListener('click', () => {
                    if (game && game.startGame) {
                        game.startGame();
                    } else {
                        console.error("startGame function not found on game object.");
                    }
                });
            } else {
                console.error("New game button not found.");
            }
        });
    </script>
</body>
</html>
